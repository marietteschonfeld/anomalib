#!/bin/bash
mvtec_ad_categories=('bottle' 'cable' 'capsule' 'carpet' 'grid' 'hazelnut' 'leather' 'metal_nut' 'pill' 'screw' 'tile' 'toothbrush' 'transistor' 'wood' 'zipper')
visa_categories=('candle' 'capsules' 'cashew' 'chewinggum' 'fryum' 'macaroni1' 'macaroni2' 'pcb1' 'pcb2' 'pcb3' 'pcb4' 'pipe_fryum')

model='spalwinnn'

interpolation_mode='bilinear'
pooling='True'
K=-1
window_sizes=(9 11 13 15)
detection='True'

gpu_type='cuda'
gpu_number='0'
write_scores='experiment_3.csv'

for window_size in "${window_sizes[@]}"; do
    for category in "${mvtec_ad_categories[@]}"; do
        python runner.py --model "$model" --dataset mvtec_ad --category "$category" --gpu_type "$gpu_type" --gpu_number "$gpu_number" --write_scores "$write_scores" --interpolation_mode "$interpolation_mode" --pooling "$pooling" --K "$K" --window_size "$window_size" --anomaly_map_detection "$detection"
    done

    for category in "${visa_categories[@]}"; do
        python runner.py --model "$model" --dataset visa --category "$category" --gpu_type "$gpu_type" --gpu_number "$gpu_number" --write_scores "$write_scores" --interpolation_mode "$interpolation_mode" --pooling "$pooling" --K "$K" --window_size "$window_size" --anomaly_map_detection "$detection"
    done
done
